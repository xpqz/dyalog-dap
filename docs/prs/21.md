# PR Description - Issue #21

Issue: #21 - Validate undocumented commands across target Dyalog versions  
Branch: codex/21-validate-undocumented-commands-across-target-dyalog-versions  
Plan reference: /Users/stefan/work/lsp-dap/docs/plans/ride-protocol.md (sections 7 and 12)

## Summary

This change validates and codifies support for the undocumented command subset identified in the plan by adding explicit protocol models, command recognition, decode coverage, and a recorded reference-evidence validation note.

## Why this change

These commands are used in real clients but were not explicitly modeled in the protocol layer. Making them first-class known commands improves compatibility and reduces ambiguity during runtime handling.

## Scope of changes

Files changed:

- /Users/stefan/work/lsp-dap/internal/ride/protocol/codec.go
- /Users/stefan/work/lsp-dap/internal/ride/protocol/codec_test.go
- /Users/stefan/work/lsp-dap/docs/validations/21-undocumented-commands.md

Implemented in `codec.go`:

- added typed models:
  - `SetSIStackArgs`
  - `ExitMultilineInputArgs`
  - `SetSessionLineGroupArgs`
- added known-command registration for:
  - `SetSIStack`
  - `ExitMultilineInput`
  - `SetSessionLineGroup`
- added decoders for each of the above commands.

Implemented in `codec_test.go`:

- added `TestDecodePayload_UndocumentedCommandSubset_DecodesTypedArgs` covering:
  - `GetWindowLayout`
  - `SetSIStack`
  - `ExitMultilineInput`
  - `SetSessionLineGroup`

Documentation:

- added `/Users/stefan/work/lsp-dap/docs/validations/21-undocumented-commands.md` with reference evidence pointers and validation scope/results.

## Test coverage

New protocol decode test verifies that the undocumented subset is marked known and decoded into expected typed argument models.

## Validation performed

Commands run:

- `gofmt -w internal/ride/protocol/codec.go internal/ride/protocol/codec_test.go`
- `go test ./internal/ride/protocol -count=1`
- `go test ./... -count=1`
- `go vet ./...`

Result:

- all tests pass
- vet clean

## Compatibility and risk

Behavior notes:

- targeted undocumented commands are now explicitly represented in protocol decoding
- unknown-command fallback remains unchanged for future protocol drift

Known limitation in this PR:

- live interpreter matrix validation across specific Dyalog versions is still pending integration-harness execution in subsequent testing-track issues.

## Out of scope

Not part of this PR:

- full live version-matrix execution against installed Dyalog builds
- adapter-level behavioral handling of these commands beyond protocol decode support

## Reviewer guide

Suggested review order:

1. `/Users/stefan/work/lsp-dap/internal/ride/protocol/codec_test.go`
2. `/Users/stefan/work/lsp-dap/internal/ride/protocol/codec.go`
3. `/Users/stefan/work/lsp-dap/docs/validations/21-undocumented-commands.md`
