# PR Description - Issue #57

Issue: #57 - Add VS Code integration test coverage for diagnostic bundle command  
Branch: codex/57-add-vs-code-integration-test-coverage-for-diagnostic-bundle-command  
Plan reference: /Users/stefan/work/lsp-dap/docs/plans/ride-protocol.md (validation rigor and supportability)  
Context references: /Users/stefan/work/lsp-dap/docs/reviews/56.md, /Users/stefan/work/lsp-dap/README.md, parent epic #45

## Summary

This change adds extension-level integration coverage that activates the extension, invokes `dyalogDap.generateDiagnosticBundle`, and validates that a redacted diagnostic artifact is emitted to the expected workspace location.

## Why this change

Issue #56 delivered the diagnostic bundle flow, but review identified a testing gap: no command-level integration test to detect command registration or artifact emission regressions.

## Scope of changes

Files changed:

- `/Users/stefan/work/lsp-dap/scaffold_test.go`
- `/Users/stefan/work/lsp-dap/vscode-extension/src/test/extensionBundleCommand.integration.test.ts`

### Added scaffold guard

Introduced `TestScaffold_HasDiagnosticBundleIntegrationCommandTest` to enforce the presence/content of a dedicated command integration test file.

### Added command integration test

Implemented `extensionBundleCommand.integration.test.ts` that:

- stubs the VS Code runtime API surface needed by `activate()`
- activates the extension and verifies `dyalogDap.generateDiagnosticBundle` command registration
- invokes the registered command handler
- asserts bundle creation under `.dyalog-dap/support/diagnostic-bundle-*.json`
- validates structural sections (diagnostics/config snapshot/transcript pointers)
- validates redaction behavior in emitted artifact fields

## Validation performed

Commands run:

- `go test ./... -count=1`
- `go vet ./...`
- `cd vscode-extension && npm run lint`
- `cd vscode-extension && npm test -- --runInBand`
- `cd vscode-extension && npm run build`

Result:

- all checks pass

## Compatibility and risk

Behavioral impact:

- test-only change; no runtime adapter or extension behavior changes

Risk:

- low; test harness stubs VS Code module loader for integration-style execution path and restores loader/env state after run.

## Reviewer guide

Suggested review order:

1. `/Users/stefan/work/lsp-dap/vscode-extension/src/test/extensionBundleCommand.integration.test.ts`
2. `/Users/stefan/work/lsp-dap/scaffold_test.go`
