# PR Description - Issue #46

Issue: #46 - Convert extension scaffold to TypeScript source/build pipeline  
Branch: codex/46-convert-extension-scaffold-to-typescript-source-build-pipeline  
Plan reference: /Users/stefan/work/lsp-dap/docs/plans/ride-protocol.md (sections 9, 10, 11)  
Context reference: /Users/stefan/work/lsp-dap/README.md

## Summary

This change upgrades the VS Code extension from a compiled-JS scaffold to a maintainable TypeScript development pipeline with CI checks.

It adds:

- TypeScript source layout for extension code (`src/`)
- `tsconfig` + npm scripts (`build`, `lint`, `test`)
- extension unit tests for adapter path/config helper behavior
- CI job that installs, lints, tests, and builds the extension package
- updated docs for local extension development loop

## Why this change

Issue #46 requires an actual source/build/test toolchain for the extension so future UX and product work can be implemented safely.

Previously:

- extension logic lived only in `out/extension.js`
- no package-level lint/test/build pipeline existed
- CI did not validate extension package integrity

## Scope of changes

Files changed:

- `/Users/stefan/work/lsp-dap/vscode-extension/package.json`
- `/Users/stefan/work/lsp-dap/vscode-extension/package-lock.json`
- `/Users/stefan/work/lsp-dap/vscode-extension/tsconfig.json`
- `/Users/stefan/work/lsp-dap/vscode-extension/src/extension.ts`
- `/Users/stefan/work/lsp-dap/vscode-extension/src/adapterPath.ts`
- `/Users/stefan/work/lsp-dap/vscode-extension/src/test/adapterPath.test.ts`
- `/Users/stefan/work/lsp-dap/vscode-extension/out/extension.js`
- `/Users/stefan/work/lsp-dap/vscode-extension/out/adapterPath.js`
- `/Users/stefan/work/lsp-dap/.github/workflows/ci.yml`
- `/Users/stefan/work/lsp-dap/scaffold_test.go`
- `/Users/stefan/work/lsp-dap/.gitignore`
- `/Users/stefan/work/lsp-dap/README.md`

### Extension pipeline

Added TypeScript baseline:

- `tsconfig.json` with strict compile settings and `src -> out` compilation
- npm scripts:
  - `build`: compile TS to `out/`
  - `lint`: type-check/no-emit baseline
  - `test`: compile then run Node test runner over compiled tests

Added dev dependencies:

- `typescript`
- `@types/node`
- `@types/vscode`

### Source conversion (behavior parity)

Moved extension logic into TS:

- `src/extension.ts` (activation + adapter descriptor wiring)
- `src/adapterPath.ts` (adapter path resolution helpers)

Maintained parity with existing behavior:

- debug type `dyalog-dap`
- same default debug config resolution
- same adapter path discovery order
- same env propagation behavior

### Extension tests

Added package-level tests:

- `src/test/adapterPath.test.ts`

Coverage includes:

- workspace token expansion
- object guard behavior
- explicit adapter path preference
- env/workspace fallback resolution

### CI integration

Added `extension-package` job to `/Users/stefan/work/lsp-dap/.github/workflows/ci.yml`:

- `npm ci` in `vscode-extension/`
- `npm run lint`
- `npm run test`
- `npm run build`

`full-suite` and `live-dyalog` now depend on `extension-package` in addition to Go critical gate.

### Scaffold and docs

Added scaffold tests to enforce pipeline presence and CI job snippets.

Updated README:

- corrected extension status language
- added explicit extension dev loop commands (`npm install`, `npm run lint/test/build`)

## Validation performed

Commands run:

- `go test ./... -run 'TestScaffold_HasVSCodeExtensionTypeScriptPipeline|TestScaffold_HasCIExtensionPackageJob' -count=1`
- `go test ./... -count=1`
- `go vet ./...`
- `npm run lint && npm run test && npm run build` (in `/Users/stefan/work/lsp-dap/vscode-extension`)

Result:

- all checks pass

## Compatibility and risk

Behavior changes:

- extension implementation source is now TS-based; runtime behavior remains equivalent.

Risk:

- low; this is primarily build/test/tooling hardening with targeted helper tests and CI enforcement.

## Reviewer guide

Suggested review order:

1. `/Users/stefan/work/lsp-dap/vscode-extension/src/extension.ts`
2. `/Users/stefan/work/lsp-dap/vscode-extension/src/adapterPath.ts`
3. `/Users/stefan/work/lsp-dap/vscode-extension/src/test/adapterPath.test.ts`
4. `/Users/stefan/work/lsp-dap/vscode-extension/package.json`
5. `/Users/stefan/work/lsp-dap/.github/workflows/ci.yml`
