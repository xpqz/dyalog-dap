# PR Description - Issue #56

Issue: #56 - Add diagnostic bundle and support triage workflow  
Branch: codex/56-add-diagnostic-bundle-and-support-triage-workflow  
Plan reference: /Users/stefan/work/lsp-dap/docs/plans/ride-protocol.md (supportability and diagnostics objectives)  
Context references: /Users/stefan/work/lsp-dap/README.md, parent epic #45

## Summary

This change adds an end-to-end support bundle flow in the VS Code extension, with automatic redaction and a documented first-pass triage process.

## Why this change

Issue #56 requires one command-driven artifact that support can request from users without requiring protocol-level expertise. The artifact must contain enough runtime context for fast triage while staying safe to share.

## Scope of changes

Files changed:

- `/Users/stefan/work/lsp-dap/vscode-extension/src/extension.ts`
- `/Users/stefan/work/lsp-dap/vscode-extension/src/diagnosticsBundle.ts`
- `/Users/stefan/work/lsp-dap/vscode-extension/src/test/diagnosticsBundle.test.ts`
- `/Users/stefan/work/lsp-dap/vscode-extension/package.json`
- `/Users/stefan/work/lsp-dap/vscode-extension/README.md`
- `/Users/stefan/work/lsp-dap/README.md`
- `/Users/stefan/work/lsp-dap/docs/support/triage.md`
- `/Users/stefan/work/lsp-dap/scaffold_test.go`
- `/Users/stefan/work/lsp-dap/vscode-extension/out/extension.js`
- `/Users/stefan/work/lsp-dap/vscode-extension/out/diagnosticsBundle.js`

### VS Code command wiring

Added `dyalogDap.generateDiagnosticBundle` command implementation in the extension:

- collects recent extension diagnostics via an in-memory mirrored history buffer
- snapshots launch configuration and active debug session metadata
- captures transcript pointers from launch config/env defaults
- builds redacted bundle payload
- writes bundle to `.dyalog-dap/support/diagnostic-bundle-<timestamp>.json`

### Redaction and bundle model

Added `diagnosticsBundle.ts` with:

- bundle schema builder
- recursive redaction for sensitive keys
- redaction of likely endpoint/path values for safer sharing
- stronger credential-key coverage (including PAT-style keys without clobbering PATH fields)

### Environment snapshot hardening

Bundle generation now captures a curated environment subset (Dyalog/RIDE and basic runtime keys) rather than the entire process environment, reducing accidental secret exposure risk while keeping triage-relevant context.

### Support triage documentation

Added `/Users/stefan/work/lsp-dap/docs/support/triage.md` with:

- operator workflow for collecting the bundle
- explicit redaction verification step
- first-pass triage checklist and escalation package expectations

### Scaffold and docs updates

- scaffold test enforces command/docs/test file presence for this workflow
- extension README and root README now document the command and triage guide

## Validation performed

Commands run:

- `go test ./... -count=1`
- `go vet ./...`
- `cd vscode-extension && npm run lint`
- `cd vscode-extension && npm test -- --runInBand`
- `cd vscode-extension && npm run build`

Result:

- all checks pass

## Compatibility and risk

Behavioral impact:

- adds a new optional support command only; no protocol/runtime behavior changes in adapter transport/execution paths

Risk:

- low. Primary risk is over-redaction or under-redaction of uncommon custom fields; documented manual scrub step remains in triage procedure.

## Reviewer guide

Suggested review order:

1. `/Users/stefan/work/lsp-dap/vscode-extension/src/extension.ts`
2. `/Users/stefan/work/lsp-dap/vscode-extension/src/diagnosticsBundle.ts`
3. `/Users/stefan/work/lsp-dap/vscode-extension/src/test/diagnosticsBundle.test.ts`
4. `/Users/stefan/work/lsp-dap/docs/support/triage.md`
5. `/Users/stefan/work/lsp-dap/README.md`
