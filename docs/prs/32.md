# PR Description - Issue #32

Issue: #32 - Add DAP protocol tests for initialize/threads/stack/step/continue/breakpoints  
Branch: codex/32-add-dap-protocol-tests-for-initialize-threads-stack-step-continue-breakpoints  
Plan reference: /Users/stefan/work/lsp-dap/docs/plans/ride-protocol.md (sections 8, 9, and 10)

## Summary

This change adds a deterministic adapter-level DAP phase-1 flow test that exercises the full request sequence for initialize, launch, threads, stackTrace, step, continue, and setBreakpoints in one cohesive scenario.

## Why this change

The issue calls for deterministic DAP protocol coverage across the phase-1 feature surface. Existing tests covered individual behaviors; this adds a single integrated protocol script with concrete assertions at each step.

## Scope of changes

Files changed:

- /Users/stefan/work/lsp-dap/internal/dap/adapter/protocol_flow_test.go

Implemented test:

- `TestDAPProtocol_Phase1DeterministicFlow`

Scenario coverage includes:

- initialize + initialized event
- launch transition
- cached thread polling path (`threads` + `GetThreads`)
- tracer lifecycle hydration via `OpenWindow` + `SetHighlightLine`
- stackTrace frame/coordinate mapping
- step (`next` -> `RunCurrentLine`) and continue (`continue` -> `Continue`) command mapping
- breakpoints (`setBreakpoints` -> `SetLineAttributes`) with verified response and 0-based stop translation

## Test coverage

New deterministic flow test provides adapter-level DAP protocol coverage across the phase-1 command set listed in issue scope.

## Validation performed

Commands run:

- `gofmt -w internal/dap/adapter/protocol_flow_test.go`
- `go test ./internal/dap/adapter -count=1 -run TestDAPProtocol_Phase1DeterministicFlow`
- `go test ./... -count=1`
- `go vet ./...`

Result:

- all tests pass
- vet clean

## Compatibility and risk

Behavior notes:

- phase-1 DAP request mapping is now covered as an end-to-end adapter script

Known limitations in this PR:

- focuses on deterministic happy-path flow; error-path protocol scenarios remain covered by existing targeted tests

## Out of scope

Not part of this PR:

- VS Code UI-level integration harness assertions
- non-phase-1 DAP feature sets

## Reviewer guide

Suggested review order:

1. `/Users/stefan/work/lsp-dap/internal/dap/adapter/protocol_flow_test.go`
