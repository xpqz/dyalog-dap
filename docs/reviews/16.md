# Review: Issue #16 - Enforce SaveChanges -> ReplySaveChanges -> CloseWindow ordering

## Summary

Implementation meets issue scope and plan section 4 ordering requirements. Dispatcher now tracks in-flight save state per window and defers close commands until corresponding `ReplySaveChanges` acknowledgement, with regression tests covering the critical and failure-edge flows.

## Findings

No findings.

Residual risk/test gap: deferred close commands that fail during transport write remain buffered in memory and currently require a later successful trigger to flush.

## Verification

- Tests: pass (`go test ./... -count=1`)
- Vet: clean (`go vet ./...`)
- Format: clean (`gofmt -l internal/ride/sessionstate/dispatcher.go internal/ride/sessionstate/dispatcher_test.go`)
- Clippy: not applicable (Go repository)

## Recommendation

Approve
